#!/bin/bash

# SPDX-FileCopyrightText: 2022-present Intel Corporation
#
# SPDX-License-Identifier: Apache-2.0

set -x
export GOPRIVATE=github.com/onosproject/*
mkdir -p build/_input
rm -rf build/_input/$1
cp -r plugins/$1 build/_input/$1
go run github.com/onosproject/onos-p4-plugins/cmd/onos-p4-plugins gen-deps $1 --target $2 > build/_input/$1/go.mod
cd build/_input/$1 && go mod tidy && go mod vendor && cd ../..
